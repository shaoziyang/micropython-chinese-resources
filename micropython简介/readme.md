# MicroPython 简介

## MicroPython 是什么

可能很多读者还不太清楚 MicroPython 是什么？也有一些读者听说了 MicroPython，但是还不太清楚它到底有什么用。从单词的组成看，它是由 micro 和 python 两个部分组成，micro 是微小的意思，而 python 是一种编程语言，两者合起来的字面意思就是微型的
python。实际上 MicroPython 就是用于嵌入式系统上的 python，可以用 miropyton 在嵌入式系统中编程，做各种应用。

在嵌入式编程中，我们传统上都是使用 C/C++、汇编等软件。而 python 是一种脚本语言，为什么要去用 python 编程呢？它有什么特点呢？让我们先从 MicroPython 的历史说起。

## MicroPython 的历史

现在开源硬件中最热门的 MicroPython 是英国剑桥大学的教授 Damien George（达米安·乔治）所发明，Damien George 是一名计算机工程师，他每天都要使用 Python 语言工作，同时也在做一些机器人项目。有一天，他突然冒出了一个想法：能否用 Python 语言来
控制单片机，进行实现对机器人的操控呢？

可能很多读者都知道，Python 是一款非常容易使用的脚本语言，它的语法简洁，使用简单，功能强大，容易扩展。而且 python 有强大的社区支持，有非常多的库可以使用，它的网络功能和计算功能也很强，可以方便的和其它语言配合使用，使用者也可以开发自己库，因此 python 被广泛应用于工程管理、网络编程、科学计算、人工智能、机器人、教育等许多行业，python 语言也长期在多个编程语言排行榜上处于前五的位置（近几年更是一直排名榜首）。更重要的是 python 也是完全开源的，不像 Windows、Java 那样受到某些大公司的控制和影响，它完全是靠社区在推动和维护，所以 python 受到越来越多的开发者青睐。不过遗憾的是，因为受到硬件成本、运行性能、开发习惯等一些原因的影响，前些年python 并没有在通用嵌入式方面得到太多的应用。

随着半导体技术和制造工艺的快速发展，芯片的升级换代速度也越来越快，芯片的功能、内部的存储器容量和资源不断增加，性能也越来越强，而成本却在不断降低。特别是随着象 ST 公司和乐鑫公司高性价比的芯片和方案应用越来越多，这就给 python 在低端嵌入式系统上的应用带来了可能。

Damien 花费了六个月的时间开发了 MicroPython。MicroPython 本身使用 GNU C 进行开发，在 ST 公司的微控制器上实现了 Pyton 3 的基本功能，拥有完善的解析器、编译器、虚拟机和类库等。在保留了 python 语言主要特性的基础上，他还对嵌入式系统的底层做了非常不错的封装，将常用功能都封装到库中，甚至为一些常用的传感器和硬件编写了专门的驱动。我们使用时只需要通过调用这些库和函数，就可以快速控制 LED、液晶、舵机、多种传感器、SD、UART、I2C 等，实现各种功能，而不用再去研究底层模块的使用方法。这样不但降低了开发难度，而且减少了重复开发工作，可以加快开发速度，提高了开发效率。以前需要较高水平的嵌入式工程师花费数天甚至数周才能完成的功能，现在普通的嵌入式开发者用几个小时就能实现类似的功能，而且要更加轻松和简单。

为了宣传 MicroPython，2014 年的时候 Damien 在 KickStarter （国外最著名的众筹网站之一）上进行了一次众筹，众筹的内容就是我们后面将要介绍的 Pyboard（PYBV1.0）。PYB V10 是专门为 MicroPython 而设计，它使用了 STM32F405RG 微控制器，开发板上内置了 4 个不同颜色的 LED 指示灯、一个三轴加速传感器、一个 microSD 插座，可以通过 USB 下载用户程序和升级固件，使用非常方便。PYB V10 在 KickStarter 上的众筹非常成功，一推出就受到全世界的工程师和爱好者的广泛关注和参与，获得很高的评价，并很快被移植到多个硬件平台上，很多爱好者用它做出各种有趣的东西。
MicroPython 最早是在 STM32F4 微控制器平台上实现的，现在已经移植到 STM32L4、STM32F7、 ESP8266、 ESP32、 CC3200、 SAM D21/SAM D51、 nRF51/nRF52、 MIMXRT10XX、renesas-ra 等众多硬件平台上，此外还有不少开发者在尝试将 MicroPython 移植到更多的硬件平台上，还有更多的开发者在使用 MicroPython 做嵌入式应用，并将它们在网络上分享。

MicroPython 并不是在单片机/微控制器上唯一尝试使用 python 编程的，更早还有象PyMite 这样的开源项目，但是它们都没有真正完成，而 MicroPython 是第一个真正在嵌入式系统上完整实现了 Python3 的核心功能，并能够真正用于产品开发的工具。
除了 MicroPython，在嵌入式系统上还有象 Lua、Javascript、MMBasic 等脚本编程语言。但是它们都没有 MicroPython 的功能完善，性能也没有 MicroPython 好，在可移植性、使用的简便方面都不如 MicroPyton，可以使用的各种资源也比较少，因此影响并不是
太大，只是在创客和 DIY 方面有所应用。

## MicroPython 的特点

MicroPython 并没有带来一种全新的编程语言，但是它的意义却超过了一种新式的编程语言。它为嵌入式开发带来了一种新的编程方式和思维，就像以前的嵌入式工程师从汇编语言转到 C 语言开发一样。它的目的不是要取代 C 语言和传统的开发方式，而是让大家可以将重点放在应用层的开发上，嵌入式工程师可以不需要每次从最底层开始构建系统，可以直接从经过验证的硬件系统和软件架构开始设计，减少了底层硬件设计和软件调试的时间，提高了开发效率。同时它也降低了嵌入式开发的门槛，让一般的开发者也可以快速开发网络、物联网、机器人应用。

随着硬件的高速发展，传统的嵌入式开发方式逐渐显露出一些问题。现在的芯片越来越复杂，更新换代也越来越快，几乎每隔半年到一年，各硬件厂家都会推出很多新型号的芯片，或者包含了新的功能，或者提高了性能。以前的嵌入式开发中，以 8 位单片机为主，芯片虽然也很复杂，但是寄存器不算多，用法也简单，用不长的时间就能初步掌握。而现在的 ARM 和其它的 32 位、64 位芯片，寄存器非常多，使用上也非常复杂，很少有工程师还能停留在寄存器级别进行复杂的软件开发了。如果说以前的工程师通过几天就可以熟悉一种单片机、几个星期就能初步掌握它、几个月就能熟练应用开发产品，现在就很少有工程师能够跟上芯片更新的步伐了。而且现在的环境一般也不会再允许大家先去学习几个月的时间，学会了再去使用它，很多时候都是边用边学。以前的工程师只要深入掌握了一两种单片机就可以在很长时间里应对大部分的应用，现在就需要使用硬件厂家提供各种函数库和辅助开发工具，才能充分利用控制器的各种新功能，如：ST 公司的 CubeMX、NXP公司 CodeWarrior 中的 PE、Silabs 公司 Simplicity Studio 的 Hardware configurator、Microchip 公司的 MCC 等。虽然这些工具也可以带来很大的方便，但是各厂家的工具都不相同，库函数也是互不兼容，使用这些工具开发的程序很难直接移植，给我们的系统设计和维护带来许多不便。
而 MicroPython 让我们在应用层级别去移植程序有了可能，就像 PC 上的程序那样。以前使用 C/C++编程时，虽说 C/C++也是高级编程语言，可以方便程序移植，但是实际开发中由于 C/C++语言本身的复杂性、硬件平台的多样性、开发工具的依赖性等因素，造成在实际产品中程序移植变得并不容易，有时进行系统移植还不如重新开发来的简便。而MicroPython 是脚本语言，在应用层和硬件的相关性比较小，加上 python 语言本身简洁的特性，所以程序移植也变得容易了。加上 python 社区和 github 上有庞大的库，大部分通用功能和设备驱动都可以在其中找到，而且很多库都可以不加修改直接使用。
传统的开发方式，是先编写代码，然后编译、下载、运行调试，对于一个复杂的系统，这个步骤相对比较繁琐。使用 micropython 开发，基本过程就是编写代码，然后运行调试，无需编译和下载，可以立即看到修改后的效果，在调试时可以极大提高效率，节约时间。特别在调试传感器时，可以快速查看和修改寄存器，比传统方式要方便很多。

在物联网时代，嵌入式系统开发的要求和以前有所变化，需要程序能够灵活多变、快速响应用户的需求。传统开发时，需要修改项目文件，然后提供新的二进制文件进行升级，通常需要更新整个系统固件，现场维护和远程升级都比较复杂。而 MicroPython 拥有灵活的文件系统，通常只需要升级用户程序，甚至可以有针对性的只升级部分文件，对于远程维护更加快速简便。
MicroPython 的特点是简单易用、移植性好、程序容易维护，但是 MicroPython 和其它的脚本语言（如 Javascript）开发的程序，运行效率肯定没有 C/C++、汇编这样编译型的工具高，它不会取代传统的 C/C++/汇编语言，但是在很多情况下，硬件的性能是过剩的，稍微降低一点运行效率并不会有太大影响，而 MicroPython 带来的开发效率整体提升，应用上的灵活性和可移植性，系统维护上方便性，才是最大的好处。

如果说 Arduino 将电子爱好者、DIYer、创客带入了嵌入式领域，让他们不在畏惧硬件的开发和使用。那么 MicroPython 完全就可以做为工具去开发真正的产品，让更多工程师和爱好者都可以快速开发嵌入式程序，让嵌入式开发和移植变得轻松和简单，真正成为全栈工程师。
