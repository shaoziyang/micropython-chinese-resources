# 与Matt Trentini一起探讨MicroPython

原文: https://agileembeddedpodcast.com/episodes/micropython-with-matt-trentini

我们与 Planet Innovation 的首席软件工程师 Matt Trentini 讨论了如何使用 MicroPython 进行专业嵌入式开发——包括医疗设备。Matt 分享了他在对传统基于 C 的工作流程感到厌倦后，如何重新被嵌入式开发吸引，并解释了为什么 MicroPython 的交互式 REPL 和快速开发周期成为团队的游戏规则改变者。

我们探讨了在微控制器上使用解释型语言的实际情况：Planet Innovation 如何用于 B 类医疗设备，性能权衡具体表现如何，以及 Unix 端口等功能如何实现强健的测试。Matt 带我们了解部署的考虑，解释如何在需要时集成 C 代码，并分享了 C++中无法实现的实时客户端演示的精彩故事。

无论你是对嵌入式系统中的高级语言持怀疑态度，还是对传统开发流程的替代方案感到好奇，这场对话都提供了一个扎实、以工程为导向的视角，探讨 MicroPython 在生产环境中能做什么、不能做什么。


**语音文件下载**：https://cdn.simplecast.com/audio/b6fcc9a4-5bba-47de-805f-35f44e305655/episodes/ab79922b-c505-44e6-b34b-a4317cf2241e/audio/fbe6d1cc-2e27-4fb1-af36-871e3392b8a3/default_tc.mp3

**语音主要议题**

- [03:30] 马特的背景以及为何 MicroPython 将他带回嵌入式开发领域
- [08:45] MicroPython是什么：一个针对微控制器完全重新实现的Python，具备REPL（解释器）、文件系统和机器模块
- [13:20] Planet Innovation 是如何通过一个 OpenMV 视觉处理项目引入 MicroPython 的
- [17:15] REPL 在交互式硬件开发和测试中的颠覆性力量
- [21:40] 在x86上运行MicroPython代码进行测试，以及模拟机器库方法
- [26:30] Python库兼容性：哪些能运行，哪些不能，以及内存方面的考虑
- [29:50] 通过扩展模块为性能关键部分集成C和C++代码
- [33:10] 性能现状：解释器执行速度较慢，通常为10-100倍，但必要时可降至C语言执行速度
- [37:45] 工具：MPRemote、神奇的挂载功能以及开发工作流程
- [42:20] 何时不宜使用MicroPython：对成本敏感的大批量产品以及资源受限的情况
- [45:30] 在B类医疗设备和安全关键应用中使用MicroPython
- [49:15] 垃圾回收：简单、可预测且可控——必要时可禁用
- [52:40] 实时客户端演示故事：在通话过程中修改状态机并立即显示结果
- [56:20] 部署：冻结代码、禁用REPL和文件系统，以及OTA（Over-the-Air）注意事项
- [01:01:30] 常见错误：逻辑错误和无意分配，而非内存崩溃
- [01:05:45] 跨平台线程、异步IO和全局解释器锁
- [01:08:20] 状态机框架：StateChart、Yasme和PyTransitions
- [01:11:40] 初级开发人员生产力：与C/C++嵌入式开发相比，上手更快
- [01:15:10] 入门指南：将板级启动作为MicroPython的理想首个用例
- [01:17:50] 硬件循环测试是尝试MicroPython的一种低风险方式



**引用名言**

> “REPL的颠覆性怎么强调都不为过。特别是作为一名嵌入式工程师，一旦你发现你可以与外设进行交互式对话，你就可以生成自己的I2C，将其发送出去，然后观察外设如何处理它——突然之间，驱动开发变得易于实验了。”——Matt Trentini

> “我的老套回答是，MicroPython的速度很慢——在解释器中比C语言慢10到100倍。但我的另一面回答是，它总是可以变得和C语言一样快，因为你可以随时切换到C语言来编写东西。”——Matt Trentini

> “在最近的一个项目中，我们曾与客户讨论状态机的工作流程。就在我们通话时，另一位工程师实际上正在对MicroPython代码进行修改。就在我们讨论细节的几分钟后，他们使用REPL展示了状态机中的更改。客户感到非常震惊——在25年的开发历程中，我从未在C和C++中体验过如此快速的反馈。”——Matt Trentini

> “如果你想和你的电子工程师们成为好朋友，那就给他们提供一个能在他们定制的电路板上运行的MicroPython版本。过去，他们通常需要等待数周甚至数月才能分配到软件资源。现在，我可以在一两天内完成一个MicroPython版本的构建，他们可以自己测试I2C、GPIO和UART。”——Matt Trentini

> “讽刺的是，那些具备C语言知识的人实际上是从MicroPython中受益最多的人。这就像拥有了一种超能力——你了解MicroPython在后台做了什么，你知道你实际上只需要编写少得多的代码。”——Matt Trentini

